---
const botUrl = "https://suchi-web-lxiveognla-uc.a.run.app";
const base = import.meta.env.BASE_URL;
const currentPath = Astro.url.pathname;
---

<!-- Floating Nav Wrapper -->
<div class="nav-wrapper">
  <nav class="site-nav" aria-label="Primary navigation">
    <!-- Logo -->
    <a href={base} class="nav-logo" aria-label="Suchitra Cancer Care Foundation - Home">
      <span class="nav-logo-mark" aria-hidden="true"></span>
      <span class="nav-logo-text">
        <span class="nav-title">Suchitra Cancer Care</span>
        <span class="nav-subtitle">Awareness · Guidance · Navigation</span>
      </span>
    </a>

    <!-- Desktop Links -->
    <div class="nav-links">
      <a href={base} class={`nav-link ${currentPath === base || currentPath === base.slice(0, -1) ? 'nav-link--active' : ''}`}>Home</a>
      <a href={`${base}about/`} class={`nav-link ${currentPath.includes('/about') ? 'nav-link--active' : ''}`}>About</a>
      <a href={`${base}watch/`} class={`nav-link ${currentPath.includes('/watch') ? 'nav-link--active' : ''}`}>Onco Talks</a>
      <a href={`${base}#contact`} class="nav-link">Contact</a>
    </div>

    <!-- Actions -->
    <div class="nav-actions">
      <a href={botUrl} target="_blank" rel="noopener" class="nav-cta">
        Ask Suchi
      </a>
      <button
        class="nav-toggle"
        id="nav-toggle"
        aria-label="Toggle menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg class="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        <svg class="icon-close" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 6l12 12M6 18L18 6"/>
        </svg>
      </button>
    </div>
  </nav>
</div>

<!-- Mobile Menu Panel -->
<nav class="mobile-menu" id="mobile-menu" aria-hidden="true">
  <a href={base}>Home</a>
  <a href={`${base}about/`}>About</a>
  <a href={`${base}watch/`}>Onco Talks</a>
  <a href={`${base}#contact`}>Contact</a>
  <a href={botUrl} target="_blank" rel="noopener" class="mobile-cta">
    Ask Suchi
  </a>
</nav>

<!-- Disclaimer Banner -->
<div class="disclaimer-banner" role="status" aria-label="Important disclaimer">
  <strong>SCCF is not a hospital or clinic.</strong> For diagnosis or treatment, consult a qualified healthcare professional.
</div>

<script>
  const toggle = document.getElementById('nav-toggle');
  const menu = document.getElementById('mobile-menu');

  toggle?.addEventListener('click', () => {
    const isOpen = menu?.getAttribute('aria-hidden') === 'false';
    menu?.setAttribute('aria-hidden', String(!isOpen));
    toggle.setAttribute('aria-expanded', String(!isOpen));
  });

  // Close on link click
  menu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      menu.setAttribute('aria-hidden', 'true');
      toggle?.setAttribute('aria-expanded', 'false');
    });
  });

  // Close on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && menu?.getAttribute('aria-hidden') === 'false') {
      menu.setAttribute('aria-hidden', 'true');
      toggle?.setAttribute('aria-expanded', 'false');
    }
  });
</script>
