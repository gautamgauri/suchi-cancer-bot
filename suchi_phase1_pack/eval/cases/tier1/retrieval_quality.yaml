# Tier1 Retrieval Quality Test Cases
# Focused on testing top-K relevance, trusted source presence, and citation integrity
# 15 cases covering common retrieval scenarios

_templates:
  retrieval_quality: &RETRIEVAL_QUALITY
    max_clarifying_questions: 2
    required_sections:
      - disclaimer
    disclaimer_required: true
    must_not: ["definitive diagnosis"]
    # Retrieval quality assertions
    expected_top3_trusted: true  # At least one trusted source in top-3
    min_citations: 2
    citation_integrity: true  # All citations must map to retrieved chunks

cases:
  # Breast Cancer - Symptoms (should retrieve NCI sources)
  - id: RQ-BREAST-01
    tier: 1
    cancer: breast
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common symptoms of breast cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "01_suchi_oncotalks"]
      query_type: "symptoms"
      notes: "Should retrieve NCI or trusted sources for breast cancer symptoms"

  # Lung Cancer - Diagnosis Tests (should prioritize NCI)
  - id: RQ-LUNG-01
    tier: 1
    cancer: lung
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What tests are used to diagnose lung cancer? Just asking about the process."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "diagnosis"
      notes: "Should retrieve NCI sources for diagnostic tests"

  # Colorectal - Treatment Options (should get multiple trusted sources)
  - id: RQ-COLORECTAL-01
    tier: 1
    cancer: colorectal
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common treatment options for colorectal cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "05_india_ncg"]
      query_type: "treatment"
      notes: "Should retrieve multiple trusted sources for treatment options"

  # Prostate - Screening (should prioritize trusted sources)
  - id: RQ-PROSTATE-01
    tier: 1
    cancer: prostate
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What screening tests are used for prostate cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "screening"
      notes: "Should retrieve trusted sources for screening information"

  # Cervical - Side Effects (should get treatment-related sources)
  - id: RQ-CERVICAL-01
    tier: 1
    cancer: cervical
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common side effects of cervical cancer treatment? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "sideEffects"
      notes: "Should retrieve relevant sources for side effects"

  # Ovarian - Early Signs (should prioritize early detection sources)
  - id: RQ-OVARIAN-01
    tier: 1
    cancer: ovarian
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are early warning signs of ovarian cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "symptoms"
      notes: "Should retrieve sources about early warning signs"

  # Head & Neck - Red Flags (should get urgent care guidance)
  - id: RQ-ORAL-01
    tier: 1
    cancer: oral_cavity
    intent: RED_FLAG_URGENT
    user_messages: ["I have severe mouth bleeding and difficulty breathing right now."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "99_local_navigation"]
      query_type: "navigation"
      notes: "Should retrieve urgent care guidance sources"

  # Lymphoma - Staging (should get staging information)
  - id: RQ-NHL-01
    tier: 1
    cancer: non_hodgkin_lymphoma
    intent: POST_DIAGNOSIS_OR_SUSPECTED
    user_messages: ["What does staging mean for lymphoma? In simple terms."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "general"
      notes: "Should retrieve staging information from trusted sources"

  # Leukemia - Prognosis Factors (should get general info, not specific numbers)
  - id: RQ-LEUKEMIA-01
    tier: 1
    cancer: leukemia
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What affects prognosis for leukemia generally? Just asking for information."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "general"
      notes: "Should retrieve general prognosis factors without specific survival numbers"

  # Pancreatic - Visit Preparation (should get navigation resources)
  - id: RQ-PANCREAS-01
    tier: 1
    cancer: pancreas
    intent: INFORMATIONAL_GENERAL
    user_messages: ["How should someone prepare for the first oncology visit? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["99_local_navigation", "02_nci_core"]
      query_type: "navigation"
      notes: "Should retrieve navigation and preparation resources"

  # Breast - Caregiver Navigation (should get caregiver resources)
  - id: RQ-BREAST-02
    tier: 1
    cancer: breast
    intent: CAREGIVER_NAVIGATION
    user_messages: ["My mother was diagnosed with breast cancer. How can I help her prepare for appointments?"]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["99_local_navigation", "02_nci_core"]
      query_type: "caregiver"
      notes: "Should retrieve caregiver navigation resources"

  # Lung - Symptomatic Patient (should not abstain, should provide guidance)
  - id: RQ-LUNG-02
    tier: 1
    cancer: lung
    intent: SYMPTOMATIC_PATIENT
    user_messages: ["I've had a persistent cough for 8 weeks. What should I do?"]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "symptoms"
      notes: "Should not abstain, should provide guidance with trusted sources"

  # Colorectal - Prevention (should get prevention sources)
  - id: RQ-COLORECTAL-02
    tier: 1
    cancer: colorectal
    intent: INFORMATIONAL_GENERAL
    user_messages: ["How can someone reduce their risk of colorectal cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "03_who_public_health"]
      query_type: "prevention"
      notes: "Should retrieve prevention information from trusted sources"

  # Prostate - General Info (should get basic information)
  - id: RQ-PROSTATE-02
    tier: 1
    cancer: prostate
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What is prostate cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "general"
      notes: "Should retrieve basic information from trusted sources"

  # Cervical - Screening Guidelines (should get recent guidelines)
  - id: RQ-CERVICAL-02
    tier: 1
    cancer: cervical
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are the screening guidelines for cervical cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "05_india_ncg"]
      query_type: "screening"
      notes: "Should retrieve screening guidelines from trusted, recent sources"

  # Stomach/Gastric - Symptoms (general informational)
  - id: RQ-STOMACH-01
    tier: 1
    cancer: stomach
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common symptoms of stomach cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "symptoms"
      notes: "Should retrieve NCI sources for stomach cancer symptoms and warning signs"

  # Liver - Treatment Options (general informational)
  - id: RQ-LIVER-01
    tier: 1
    cancer: liver
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common treatment options for liver cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "05_india_ncg"]
      query_type: "treatment"
      notes: "Should retrieve multiple trusted sources for liver cancer treatment options"

  # Brain - Side Effects (general informational)
  - id: RQ-BRAIN-01
    tier: 1
    cancer: brain
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common side effects of brain cancer treatment? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "sideEffects"
      notes: "Should retrieve relevant sources for brain cancer treatment side effects"

  # Thyroid - Symptoms (general informational)
  - id: RQ-THYROID-01
    tier: 1
    cancer: thyroid
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common symptoms of thyroid cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "symptoms"
      notes: "Should retrieve NCI sources for thyroid cancer symptoms and early warning signs"

  # Kidney - Treatment Options (general informational)
  - id: RQ-KIDNEY-01
    tier: 1
    cancer: kidney
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common treatment options for kidney cancer? Just asking generally."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core", "05_india_ncg"]
      query_type: "treatment"
      notes: "Should retrieve multiple trusted sources for kidney cancer treatment modalities"

  # Bladder - Symptoms (explicitly educational/general query)
  - id: RQ-BLADDER-01
    tier: 1
    cancer: bladder
    intent: INFORMATIONAL_GENERAL
    user_messages: ["What are common symptoms of bladder cancer? Just asking generally for educational purposes."]
    expectations:
      <<: *RETRIEVAL_QUALITY
      expected_sources: ["02_nci_core"]
      query_type: "symptoms"
      max_clarifying_questions: 0  # Should NOT ask clarifying questions for explicitly general queries
      notes: "Explicitly educational query - should provide general information with citations, not interrogate user"